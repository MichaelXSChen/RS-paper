% Remember to use the lgrind style

\Head{}
\File{backup.cpp}{2016}{5}{1}{17:59}{717}
\index{main}\Proc{main}\L{\LB{\K{void}_\V{main}(\K{int}_\V{argc},_\K{char}_*\V{argv}[\,])_\{}}
\L{\LB{}\Tab{2}{\K{int}_\V{nfds}_=_\N{0};}}
\L{\LB{}\Tab{2}{\K{struct}_\V{pollfd}_\V{fds}[\V{MAX}];}}
\L{\LB{}\Tab{2}{\K{int}_\V{sock}_=_\V{socket}(.\,.\,.);}}
\L{\LB{}\Tab{2}{\V{fds}[\V{nfds}].\V{fd}_=_\V{sock};}}
\L{\LB{}\Tab{2}{\V{fds}[\V{nfds}].\V{events}_=_\V{POLLIN};}}
\L{\LB{}\Tab{2}{\V{nfds}++;}}
\L{\LB{}\Tab{2}{.\,.\,.;_\C{}//_Call_bind()_and_listen().\CE{}}}
\L{\LB{}\Tab{2}{\K{while}_(\V{poll}(\V{fds},_\V{nfds},_\N{0})_\>_\N{0})_\{}}
\L{\LB{}\Tab{4}{\K{for}_(\K{int}_\V{i}=\N{0};_\V{i}\<\V{MAX};_\V{i}++)_\{}}
\L{\LB{}\Tab{6}{\K{if}(\V{fds}[\V{i}].\V{revents}_==_\V{POLLIN})_\{}}
\L{\LB{}\Tab{8}{\K{if}_(\V{fds}[\V{i}].\V{fd}_==_\V{sock})_\{}}
\L{\LB{}\Tab{10}{\V{fds}[\V{nfds}].\V{fd}_=_\V{accept}(\V{sock},_.\,.\,.);}}
\L{\LB{}\Tab{10}{\V{fds}[\V{nfds}].\V{events}_=_\V{POLLIN};}}
\L{\LB{}\Tab{10}{\V{nfds}++;}}
\L{\LB{}\Tab{8}{\}_\K{else}_\{}}
\L{\LB{}\Tab{10}{\K{char}_\V{in}[\N{1024}],_\V{out}[\N{1024}];}}
\L{\LB{}\Tab{10}{\V{recv}(\V{fds}[\V{i}].\V{fd},_\V{in},_.\,.\,.);}}
\L{\LB{}\Tab{10}{\V{process\_request}(\V{in},_\V{out});}}
\L{\LB{}\Tab{10}{\V{send}(\V{fds}[\V{i}].\V{fd},_\V{out},_.\,.\,.);}}
\L{\LB{}\Tab{10}{\V{close}(\V{fds}[\V{i}].\V{fd});}}
\L{\LB{}\Tab{10}{\V{fds}[\V{i}].\V{fd}_=_\V{fds}[\V{i}].\V{events}_=_\N{0};}}
\L{\LB{}\Tab{10}{\V{nfds}\-\-;}}
\L{\LB{}\Tab{8}{\}}}
\L{\LB{}\Tab{6}{\}}}
\L{\LB{}\Tab{4}{\}}}
\L{\LB{}\Tab{2}{\}}}
\L{\LB{\}}}
