% Remember to use the lgrind style

\Head{}
\File{leader.cpp.lineno}{2016}{5}{4}{17:24}{667}
\L{\LB{\N{1}_\V{:}_\V{viewstamp\_t}_\V{idx};}}
\index{invoke\_consensus\_req}\Proc{invoke\_consensus\_req}\L{\LB{\N{2}_\V{:}_\K{void}_\V{invoke\_consensus\_req}(\V{node}_*\V{cur},_}}
\L{\LB{\N{3}_\V{:}}\Tab{8}{\V{call}_\V{type},_\V{data},_\V{data\_size})_\{}}
\L{\LB{\N{4}_\V{:}}\Tab{6}{\V{vs};}}
\L{\LB{\N{5}_\V{:}_}}
\L{\LB{\N{6}_\V{:}}\Tab{6}{\C{}//_Local_preparation.\CE{}}}
\L{\LB{\N{7}_\V{:}}\Tab{6}{\V{spin\_lock}();}}
\L{\LB{\N{8}_\V{:}}\Tab{6}{\V{vs}_=_\V{idx}++;}}
\L{\LB{\N{9}_\V{:}}\Tab{6}{\V{spin\_unlock}();}}
\L{\LB{\N{10}\V{:}}\Tab{6}{\V{call\_entry}_*\V{entry}_=_\V{build\_entry}(\V{cur},\V{vs},\V{data},\V{data\_size});}}
\L{\LB{\N{11}\V{:}}\Tab{6}{\V{mem\_write}(\V{cur\_log\_offset},_\V{entry});_}}
\L{\LB{\N{12}\V{:}}\Tab{6}{\V{store\_entry}(\V{entry});}}
\L{\LB{\N{13}\V{:}_}}
\L{\LB{\N{14}\V{:}}\Tab{6}{\C{}//_RDMA_write.\CE{}}}
\L{\LB{\N{15}\V{:}}\Tab{6}{\K{for}_(\V{i}_=_\N{0};_\V{i}_\<_\V{group\_size};_\V{i}++)_\{}}
\L{\LB{\N{16}\V{:}}\Tab{8}{\V{RDMA\_write}(\V{i},_\V{remote\_log\_offset}[\V{i}],_\V{entry});}}
\L{\LB{\N{17}\V{:}}\Tab{6}{\}}}
\L{\LB{\N{18}\V{:}}\Tab{6}{}}
\L{\LB{\N{19}\V{:}}\Tab{6}{\C{}//_Wait_for_quorum.\CE{}}}
\L{\LB{\N{20}\V{:}_\V{recheck:}}}
\L{\LB{\N{21}\V{:}}\Tab{6}{\K{for}_(\V{i}_=_\N{0};_\V{i}_\<_;_\V{i}++)_\{}}
\L{\LB{\N{22}\V{:}}\Tab{8}{\V{bitmap}_+=_\V{ack}[\V{i}].\V{reply};}}
\L{\LB{\N{23}\V{:}}\Tab{6}{\}}}
\L{\LB{\N{24}\V{:}}\Tab{6}{\K{if}_(\V{reach\_quorum}())_\{}}
\L{\LB{\N{25}\V{:}}\Tab{8}{\V{process\_req}();}}
\L{\LB{\N{26}\V{:}}\Tab{6}{\}_\K{else}}}
\L{\LB{\N{27}\V{:}}\Tab{8}{\K{goto}_\V{recheck};}}
\L{\LB{\N{28}\V{:}_\}}}
